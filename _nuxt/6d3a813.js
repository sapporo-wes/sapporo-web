(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{413:function(e,t,o){"use strict";var r=o(0).a.extend({data:function(){return{version:"1.1.1"}}}),n=o(74),l=o(124),c=o.n(l),d=o(491),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-footer",{attrs:{color:e.$colors.indigo.darken1,absolute:"",app:"",height:"24",padless:""}},[o("div",{staticClass:"mx-auto my-auto"},[o("span",{staticClass:"white--text",style:{fontSize:"12px"}},[e._v("\n      sapporo-web "+e._s(e.version)+" Â© Bioinformation and DDBJ Center\n    ")])])])}),[],!1,null,null,null);t.a=component.exports;c()(component,{VFooter:d.a})},424:function(e,t,o){"use strict";o(23),o(15),o(57),o(75),o(35);var r={data:function(){return{type:"",id:""}},computed:{items:function(){var e=[{text:"Home",nuxt:!0,to:"/",icon:"mdi-home-outline"}];if("service"===this.type){var t=this.$store.getters["services/service"](this.id);t&&e.push({text:t.name,nuxt:!0,to:"/services?serviceId=".concat(t.id),icon:"mdi-dns-outline"})}else if("workflow"===this.type){var o=this.$store.getters["workflows/workflow"](this.id);if(o){var r=this.$store.getters["services/service"](o.serviceId);r&&e.push({text:r.name,nuxt:!0,to:"/services?serviceId=".concat(r.id),icon:"mdi-dns-outline"}),e.push({text:o.name,nuxt:!0,to:"/workflows?workflowId=".concat(o.id),icon:"mdi-graph-outline"})}}else if("run"===this.type){var n=this.$store.getters["runs/run"](this.id);if(n){var l=this.$store.getters["workflows/workflow"](n.workflowId);if(l){var c=this.$store.getters["services/service"](n.serviceId);c&&e.push({text:c.name,nuxt:!0,to:"/services?serviceId=".concat(c.id),icon:"mdi-dns-outline"}),e.push({text:l.name,nuxt:!0,to:"/workflows?workflowId=".concat(l.id),icon:"mdi-graph-outline"})}e.push({text:n.name,nuxt:!0,to:"/runs?runId=".concat(n.id),icon:"mdi-chart-box-outline"})}}return e}},created:function(){for(var e=this.$route.query,t=0,o=Object.keys(e);t<o.length;t++){var r=o[t];if(r.includes("Id")){this.type=r.slice(0,-2);var n=e[r]||"";Array.isArray(n)&&(n=n[0]||""),this.id=n;break}}}},n=o(0).a.extend(r),l=o(74),c=o(124),d=o.n(c),f=o(607),m=o(494),v=o(399),component=Object(l.a)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-breadcrumbs",{staticClass:"pt-2",attrs:{items:e.items,large:""},scopedSlots:e._u([{key:"divider",fn:function(){return[o("v-icon",{domProps:{textContent:e._s("mdi-chevron-right")}})]},proxy:!0},{key:"item",fn:function(t){var r=t.item;return[o("v-breadcrumbs-item",{attrs:{nuxt:r.nuxt,to:r.to}},[o("v-icon",{attrs:{color:e.$colors.grey.darken2,left:""},domProps:{textContent:e._s(r.icon)}}),e._v(" "),o("span",{domProps:{textContent:e._s(r.text)}})],1)]}}])})}),[],!1,null,null,null);t.a=component.exports;d()(component,{VBreadcrumbs:f.a,VBreadcrumbsItem:m.a,VIcon:v.a})},426:function(e,t,o){"use strict";o(44);var r={props:{wfType:{type:String,default:""},size:{type:Number,default:26},topMargin:{type:Boolean,default:!0}}},n=o(74),l=o(124),c=o.n(l),d=o(399),component=Object(n.a)(r,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return"CWL"===e.wfType?r("img",{class:{"mt-2":e.topMargin,"mr-2":!0},attrs:{src:o(429),height:e.size}}):"WDL"===e.wfType?r("img",{class:{"mt-2":e.topMargin,"mr-2":!0},attrs:{src:o(430),height:e.size}}):"nextflow"===e.wfType.toLowerCase()||"NFL"===e.wfType?r("img",{class:{"mt-2":e.topMargin,"mr-2":!0},attrs:{src:o(431),height:e.size}}):"snakemake"===e.wfType.toLowerCase()||"SMK"===e.wfType?r("img",{class:{"mt-2":e.topMargin,"mr-2":!0},attrs:{src:o(432),height:e.size}}):r("v-icon",{staticClass:"my-2 mr-2",domProps:{textContent:e._s("mdi-graph-outline")}})}),[],!1,null,null,null);t.a=component.exports;c()(component,{VIcon:d.a})},429:function(e,t,o){e.exports=o.p+"img/cwl-icon.d6a463e.png"},430:function(e,t,o){e.exports=o.p+"img/wdl-icon.3954ce4.png"},431:function(e,t,o){e.exports=o.p+"img/nextflow-icon.5351591.png"},432:function(e,t,o){e.exports=o.p+"img/snakemake-icon.b8289bc.png"},477:function(e,t,o){var content=o(569);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(32).default)("ab6574da",content,!0,{sourceMap:!1})},478:function(e,t,o){var content=o(571);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(32).default)("b46bc57a",content,!0,{sourceMap:!1})},479:function(e,t,o){var content=o(573);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(32).default)("aeca8f98",content,!0,{sourceMap:!1})},480:function(e,t,o){var content=o(575);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(32).default)("46e17a59",content,!0,{sourceMap:!1})},481:function(e,t,o){var content=o(579);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(32).default)("16eb590a",content,!0,{sourceMap:!1})},568:function(e,t,o){"use strict";o(477)},569:function(e,t,o){var r=o(31)(!1);r.push([e.i,'.content-viewer[data-v-7279b7be] .CodeMirror{height:250px!important;font-size:.9rem!important}.content-viewer[data-v-7279b7be] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}.info-table[data-v-7279b7be] td:first-child{width:270px;font-weight:500}.info-table[data-v-7279b7be] tr:not(:last-child) td{border-bottom:none!important}',""]),e.exports=r},570:function(e,t,o){"use strict";o(478)},571:function(e,t,o){var r=o(31)(!1);r.push([e.i,'.content-viewer[data-v-24d4994a] .CodeMirror{height:200px!important;font-size:.9rem!important}.content-viewer[data-v-24d4994a] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}',""]),e.exports=r},572:function(e,t,o){"use strict";o(479)},573:function(e,t,o){var r=o(31)(!1);r.push([e.i,".run-table[data-v-b3f2f108] td:first-child{padding-right:0}",""]),e.exports=r},574:function(e,t,o){"use strict";o(480)},575:function(e,t,o){var r=o(31)(!1);r.push([e.i,'.content-viewer[data-v-6fc1914e] .CodeMirror{height:300px!important;font-size:.9rem!important}.content-viewer[data-v-6fc1914e] .CodeMirror-lines{font-family:"Fira Code",monospace,sans-serif!important}.content-viewer[data-v-6fc1914e] .CodeMirror-gutter-wrapper{left:-30px!important}',""]),e.exports=r},578:function(e,t,o){"use strict";o(481)},579:function(e,t,o){var r=o(31)(!1);r.push([e.i,".workflow-table[data-v-2ddf6232] td:first-child{padding-right:0}",""]),e.exports=r},599:function(e,t,o){"use strict";o.r(t);var r=o(5),n=(o(57),o(75),o(58),o(0)),l=o(199),c=o(413),d=o(424),f=(o(420),o(421),o(422),o(423)),m=o(127),v={components:{codemirror:f.codemirror},props:{serviceId:{type:String,required:!0}},data:function(){return{serviceInfoHeaders:[{text:"Key",value:"key"},{text:"Value",value:"value"}],tab:1}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},serviceInfoContents:function(){return[{key:"Service Endpoint",value:this.service.endpoint},{key:"Added Date",value:this.$dayjs(this.service.addedDate).local().format("YYYY-MM-DD HH:mm:ss")}]},tabItems:function(){var e,t,o,r,n,l,c,d,f,m,v,h;return[{key:"Workflow Type Versions",value:JSON.stringify((null===(t=null===(e=this.service)||void 0===e?void 0:e.serviceInfo)||void 0===t?void 0:t.workflow_type_versions)||"",null,2)},{key:"Workflow Engine Versions",value:JSON.stringify((null===(r=null===(o=this.service)||void 0===o?void 0:o.serviceInfo)||void 0===r?void 0:r.workflow_engine_versions)||"",null,2)},{key:"Default Workflow Engine Parameters",value:JSON.stringify((null===(l=null===(n=this.service)||void 0===n?void 0:n.serviceInfo)||void 0===l?void 0:l.default_workflow_engine_parameters)||"",null,2)},{key:"Supported Filesystem Protocols",value:JSON.stringify((null===(d=null===(c=this.service)||void 0===c?void 0:c.serviceInfo)||void 0===d?void 0:d.supported_filesystem_protocols)||(null===(m=null===(f=this.service)||void 0===f?void 0:f.serviceInfo)||void 0===m?void 0:m.supported_filesystem_protocols)||"",null,2)},{key:"Tags",value:JSON.stringify((null===(h=null===(v=this.service)||void 0===v?void 0:v.serviceInfo)||void 0===h?void 0:h.tags)||"",null,2)}]}},methods:{reloadService:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("services/updateService",e.serviceId);case 2:case"end":return t.stop()}}),t)})))()},codeMirrorMode:function(content){return Object(m.a)(content)},validUrl:function(e){return Object(m.g)(e)}}},h=n.a.extend(v),w=(o(568),o(74)),y=o(124),k=o.n(y),x=o(400),_=o(407),C=o(467),I=o(603),T=o(399),S=o(405),N=o(596),R=o(608),V=o(605),P=o(597),component=Object(w.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.service?o("v-card",{ref:"card",attrs:{"max-width":"1200"}},[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-dns-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s(e.service.name)}}),e._v(" "),e.service.preRegistered?o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-icon",e._g({staticClass:"ml-2 mt-1",attrs:{color:e.$colors.indigo.darken1},domProps:{textContent:e._s("mdi-account-check-outline")}},r))]}}],null,!1,3490612083)},[e._v(" "),o("span",{domProps:{textContent:e._s("Pre-registered WES service")}})]):e._e(),e._v(" "),o("v-spacer"),e._v(" "),o("v-chip",{staticClass:"mr-4",attrs:{color:e.$store.getters["services/stateColor"](e.service.id),"text-color":"white"},domProps:{textContent:e._s(e.service.state)}}),e._v(" "),o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-btn",e._g({attrs:{color:e.$colors.grey.darken2,outlined:"",small:""},on:{click:function(t){return t.stopPropagation(),e.reloadService.apply(null,arguments)}}},r),[o("v-icon",{domProps:{textContent:e._s("mdi-reload")}})],1)]}}],null,!1,781684642)},[e._v(" "),o("span",{domProps:{textContent:e._s("Reload WES service")}})])],1),e._v(" "),o("v-data-table",{staticClass:"mx-12 mt-2 info-table",attrs:{headers:e.serviceInfoHeaders,items:e.serviceInfoContents,"calculate-widths":"","disable-filtering":"","disable-pagination":"","disable-sort":"","hide-default-footer":"","hide-default-header":"","item-key":"key"},scopedSlots:e._u([{key:"item.value",fn:function(t){var r=t.item;return[o("span",{domProps:{textContent:e._s(r.value)}})]}}],null,!0)}),e._v(" "),o("div",{staticClass:"mx-12"},[o("v-tabs",{attrs:{vertical:"",height:"282"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[e._l(e.tabItems,(function(t){return o("v-tab",{key:t.key,style:{textTransform:"none",justifyContent:"start",letterSpacing:"normal"},domProps:{textContent:e._s(t.key)}})})),e._v(" "),e._l(e.tabItems,(function(t){return o("v-tab-item",{key:t.key},[o("codemirror",{ref:"codeMirror",refInFor:!0,staticClass:"ml-6 mr-1 mt-2 mb-6 elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,mode:e.codeMirrorMode(t.value),readOnly:"nocursor",tabSize:2},value:t.value}})],1)}))],2)],1)],1):e._e()}),[],!1,null,"7279b7be",null),W=component.exports;k()(component,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VIcon:T.a,VSpacer:S.a,VTab:N.a,VTabItem:R.a,VTabs:V.a,VTooltip:P.a});o(14),o(47),o(33),o(11),o(203),o(204),o(205),o(206),o(207),o(208),o(209),o(210),o(211),o(212),o(213),o(214),o(215),o(216),o(217),o(218),o(219),o(36),o(53);var $={props:{dialogShow:{type:Boolean,default:!1,required:!0},selectedItems:{type:Array,default:[],required:!0}},methods:{deleteSelectedItems:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("runs/deleteRuns",e.selectedItems.map((function(e){return e.runId})));case 2:e.$emit("close");case 3:case"end":return t.stop()}}),t)})))()}}},O=n.a.extend($),F=o(590),M=Object(w.a)(O,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"600"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Remove Run")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("The following run will be removed:")}}),e._v(" "),o("ul",{style:{paddingLeft:"96px",paddingRight:"96px"}},e._l(e.selectedItems,(function(t,i){return o("li",{key:i,domProps:{textContent:e._s(t.runName)}})})),0),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 mt-4 pb-6"},[o("v-btn",{attrs:{color:"error",outlined:""},on:{click:function(t){return t.stopPropagation(),e.deleteSelectedItems.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Remove")}})],1),e._v(" "),o("v-btn",{staticClass:"ml-4",attrs:{color:"info",outlined:""},on:{click:function(t){return t.stopPropagation(),e.$emit("close")}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-close")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Cancel")}})],1)],1)])],1)}),[],!1,null,null,null),D=M.exports;k()(M,{VBtn:x.a,VCard:_.a,VDialog:F.a,VIcon:T.a});o(76),o(24),o(59),o(19),o(156),o(23),o(35),o(9),o(45),o(54);var j=o(51);function E(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var U=[],L={components:{codemirror:f.codemirror},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{runId:"",getFailed:!0,runLog:void 0,runName:"",workflowName:"",workflowType:"",workflowVersion:"",workflowUrl:"",workflowContent:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},workflows:function(){return this.$store.getters["workflows/workflowsByIds"](this.service.workflowIds)},runIdRules:function(){return this.runId?this.service.runIds.includes(this.runId)?["The Run ID already exists"]:this.getFailed?["The Run could not be fetched correctly"]:[]:["Required"]},formValid:function(){return!this.runIdRules.length}},methods:{changeRunId:function(){for(var e=this;U.length;){var t=U.shift();t&&clearTimeout(t)}var o=setTimeout((function(t){e.getRunsId(t)}),1e3,this.runId);U.push(o)},getRunsId:function(e){var t=this;this.service.runIds.includes(this.runId)||Object(j.c)(this.service.endpoint,e).then((function(o){if(!(o.request&&o.run_log&&o.request.workflow_url&&o.request.workflow_type&&o.request.workflow_type_version))throw new Error("The Run could not be fetched correctly");if(t.runLog=o,"workflow_name"in o.request){var r=o.request.workflow_url||"";t.workflowName=o.request.workflow_name||r.split("/").pop()||e}else{var n=o.request.workflow_url||"";t.workflowName=n.split("/").pop()||e}var l=o.run_log.start_time;!l&&"task_started"in o.run_log&&(l=o.run_log.task_started);var c=Object(m.d)(t.$dayjs,Object(m.c)(l));t.runName="".concat(t.workflowName," ").concat(c),t.workflowType=o.request.workflow_type,t.workflowVersion=o.request.workflow_type_version;var d=[];"workflow_attachment"in o.request&&(d=JSON.parse(Object(m.c)(o.request.workflow_attachment))||[]);var f=Object(m.c)(o.request.workflow_url)||"";try{var v=new URL(f);Object(m.b)(v).then((function(e){t.workflowUrl=e}))}catch(e){var h,w=f.split("/").pop()||f,y=E(d);try{for(y.s();!(h=y.n()).done;){var k=h.value;if(k.file_name.includes(w)){t.workflowUrl=k.file_url;break}}}catch(e){y.e(e)}finally{y.f()}}Object(j.a)({workflow_name:t.workflowName,workflow_url:t.workflowUrl,workflow_type:t.workflowType,workflow_type_version:t.workflowVersion,workflow_attachment:d}).then((function(e){t.workflowContent=e})).catch((function(){throw new Error("The Workflow could not be fetched correctly")})),t.getFailed=!1})).catch((function(e){t.getFailed=!0,t.clearState()}))},clearState:function(){this.runLog=void 0,this.runName="",this.workflowName="",this.workflowType="",this.workflowVersion="",this.workflowUrl="",this.workflowContent=""},codeMirrorMode:function(content){return Object(m.a)(content)},importRun:function(){var e,t,o=this;if(this.formValid){var r=null===(e=this.workflows.filter((function(e){return e.name===o.workflowName}))[0])||void 0===e?void 0:e.id;if(r)this.$store.dispatch("runs/addRun",{serviceId:this.serviceId,workflowId:r,runId:this.runId,runName:this.runName,runLog:this.runLog});else{var n=[];(null===(t=this.runLog)||void 0===t?void 0:t.request)&&"workflow_attachment"in this.runLog.request&&(n=this.runLog.request.workflow_attachment),this.$store.dispatch("workflows/addWorkflow",{serviceId:this.serviceId,workflow:{workflow_name:this.workflowName,workflow_url:this.workflowUrl,workflow_type:this.workflowType,workflow_type_version:this.workflowVersion,workflow_attachment:n},preRegistered:!1}).then((function(e){o.$store.dispatch("services/addWorkflowId",{serviceId:o.serviceId,workflowId:e}),o.$store.dispatch("runs/addRun",{serviceId:o.serviceId,workflowId:e,runId:o.runId,runName:o.runName,runLog:o.runLog})}))}this.$router.push({path:"/runs",query:{runId:this.runId}})}}}},B=n.a.extend(L),z=(o(570),o(464)),H=Object(w.a)(B,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"900"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Import Run")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2"},[o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.runId.length,rules:e.runIdRules,hint:"Enter the Run ID included in this WES service",label:"Run ID",placeholder:"Enter the Run ID"},on:{input:e.changeRunId},model:{value:e.runId,callback:function(t){e.runId=t},expression:"runId"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Run Name",readonly:""},model:{value:e.runName,callback:function(t){e.runName=t},expression:"runName"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Workflow Name",readonly:""},model:{value:e.workflowName,callback:function(t){e.workflowName=t},expression:"workflowName"}}),e._v(" "),o("div",{staticClass:"d-flex"},[e.getFailed?e._e():o("v-text-field",{staticClass:"my-0 mr-auto",style:{maxWidth:"48%",minWidth:"48%"},attrs:{label:"Workflow Type",readonly:""},model:{value:e.workflowType,callback:function(t){e.workflowType=t},expression:"workflowType"}}),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",style:{maxWidth:"48%",minWidth:"48%"},attrs:{label:"Workflow Version",readonly:""},model:{value:e.workflowVersion,callback:function(t){e.workflowVersion=t},expression:"workflowVersion"}})],1),e._v(" "),e.getFailed?e._e():o("v-text-field",{staticClass:"ma-0",attrs:{label:"Workflow URL",readonly:""},model:{value:e.workflowUrl,callback:function(t){e.workflowUrl=t},expression:"workflowUrl"}}),e._v(" "),e.getFailed?e._e():o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.workflowContent),readOnly:"nocursor"}},model:{value:e.workflowContent,callback:function(t){e.workflowContent=t},expression:"workflowContent"}})],1),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 pb-6 mt-4"},[o("v-btn",{attrs:{disabled:!e.formValid,color:"primary",outlined:""},on:{click:function(t){return t.stopPropagation(),e.importRun.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("import")}})],1)],1)])],1)}),[],!1,null,"24d4994a",null),J=H.exports;k()(H,{VBtn:x.a,VCard:_.a,VDialog:F.a,VIcon:T.a,VTextField:z.a});var Y=o(426),K={components:{RunDeleteDialog:D,RunImportDialog:J,WorkflowIcon:Y.a},props:{serviceId:{type:String,required:!0}},data:function(){return{runHeaders:[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"runName",sortable:!0},{text:"Workflow",value:"workflowName",sortable:!0},{text:"Added Date",value:"addedDate",sortable:!0},{text:"",value:"state",sortable:!1},{text:"",value:"delete",sortable:!1,align:"center",width:"64px"}],selectedRuns:[],importDialogShow:!1,deleteDialogShow:!1,filterType:"",filterWfName:"",filterRunName:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},runsTableItems:function(){return this.$store.getters["runs/tableItems"](this.service.runIds)},filteredItems:function(){var e=this;return this.runsTableItems.filter((function(t){return(!e.filterType||t.workflowType===e.filterType)&&(!(e.filterWfName&&!t.workflowName.includes(e.filterWfName))&&!(e.filterRunName&&!t.runName.includes(e.filterRunName)))}))},workflowTypes:function(){return Array.from(new Set(this.runsTableItems.map((function(e){return e.workflowType}))))}},methods:{reloadRunState:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("runs/updateAllRunsStateByService",e.service.id);case 2:case"end":return t.stop()}}),t)})))()}}},G=n.a.extend(K),Q=(o(572),o(485)),X=Object(w.a)(G,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",{attrs:{"max-width":"1200"}},[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-chart-box-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Runs")}}),e._v(" "),o("v-spacer"),e._v(" "),e.runsTableItems.length?o("v-select",{staticClass:"mt-2 mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{items:e.workflowTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}):e._e(),e._v(" "),e.runsTableItems.length?o("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Run Name","single-line":""},model:{value:e.filterRunName,callback:function(t){e.filterRunName=t},expression:"filterRunName"}}):e._e(),e._v(" "),e.runsTableItems.length?o("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Workflow Name","single-line":""},model:{value:e.filterWfName,callback:function(t){e.filterWfName=t},expression:"filterWfName"}}):e._e(),e._v(" "),o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-btn",e._g({attrs:{color:e.$colors.grey.darken2,disabled:!e.runsTableItems.length,outlined:"",small:""},on:{click:function(t){return t.stopPropagation(),e.reloadRunState.apply(null,arguments)}}},r),[o("v-icon",{domProps:{textContent:e._s("mdi-reload")}})],1)]}}])},[e._v(" "),o("span",{domProps:{textContent:e._s("Reload run status")}})])],1),e._v(" "),e.runsTableItems.length?e._e():o("div",{staticClass:"mx-12 my-2"},[o("span",{style:{fontSize:"1rem",color:e.$colors.grey.darken4},domProps:{textContent:e._s("Executed runs will show up here.")}})]),e._v(" "),e.runsTableItems.length?o("v-data-table",{staticClass:"mx-12 my-2 run-table",attrs:{headers:e.runHeaders,"items-per-page":Number(10),items:e.filteredItems,"item-key":"runId"},scopedSlots:e._u([{key:"item.workflowType",fn:function(e){var t=e.item;return[o("workflow-icon",{attrs:{"wf-type":t.workflowType}})]}},{key:"item.runName",fn:function(t){var r=t.item;return[o("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/runs",query:{runId:r.runId}}},domProps:{textContent:e._s(r.runName)}})]}},{key:"item.workflowName",fn:function(t){var r=t.item;return[o("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/workflows",query:{workflowId:r.workflowId}}},domProps:{textContent:e._s(r.workflowName)}})]}},{key:"item.state",fn:function(t){var r=t.item;return[o("v-chip",{attrs:{color:r.stateColor,"text-color":"white"},domProps:{textContent:e._s(r.state)}})]}},{key:"item.delete",fn:function(t){var r=t.item;return[o("v-icon",{attrs:{color:e.$colors.grey.darken2},domProps:{textContent:e._s("mdi-trash-can-outline")},on:{click:function(t){t.stopPropagation(),e.selectedRuns=[r],e.deleteDialogShow=!0}}})]}}],null,!0)}):e._e(),e._v(" "),o("div",{staticClass:"d-flex justify-end pb-6 mr-12 mt-2"},[o("v-btn",{attrs:{color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.importDialogShow=!0}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Import")}})],1)],1),e._v(" "),o("run-import-dialog",{attrs:{"dialog-show":e.importDialogShow,"service-id":e.serviceId},on:{close:function(t){e.importDialogShow=!1}}}),e._v(" "),o("run-delete-dialog",{attrs:{"dialog-show":e.deleteDialogShow,"selected-items":e.selectedRuns},on:{close:function(t){e.deleteDialogShow=!1,e.selectedRuns=[]}}})],1)}),[],!1,null,"b3f2f108",null),Z=X.exports;k()(X,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VIcon:T.a,VSelect:Q.a,VSpacer:S.a,VTextField:z.a,VTooltip:P.a});var ee={props:{dialogShow:{type:Boolean,default:!1,required:!0},selectedItems:{type:Array,default:[],required:!0}},methods:{deleteSelectedItems:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("workflows/deleteWorkflows",{workflowIds:e.selectedItems.map((function(e){return e.workflowId}))});case 2:e.$emit("close");case 3:case"end":return t.stop()}}),t)})))()}}},te=n.a.extend(ee),oe=Object(w.a)(te,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"600"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Remove Workflow")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("The following workflow will be removed:")}}),e._v(" "),o("ul",{style:{paddingLeft:"96px",paddingRight:"96px"}},e._l(e.selectedItems,(function(t,i){return o("li",{key:i,domProps:{textContent:e._s(t.workflowName)}})})),0),e._v(" "),o("div",{staticClass:"mx-12 my-2",domProps:{textContent:e._s("Runs associated with this workflow will also be removed.")}}),e._v(" "),o("div",{staticClass:"d-flex justify-end mx-12 mt-4 pb-6"},[o("v-btn",{attrs:{color:"error",outlined:""},on:{click:function(t){return t.stopPropagation(),e.deleteSelectedItems.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-trash-can-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Remove")}})],1),e._v(" "),o("v-btn",{staticClass:"ml-4",attrs:{color:"info",outlined:""},on:{click:function(t){return t.stopPropagation(),e.$emit("close")}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-close")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Cancel")}})],1)],1)])],1)}),[],!1,null,null,null),re=oe.exports;k()(oe,{VBtn:x.a,VCard:_.a,VDialog:F.a,VIcon:T.a});o(61);function ne(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var se=[],ae={components:{codemirror:f.codemirror},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{name:"",type:"",version:"",locationMode:"fetch",url:"",fetchFailed:!1,wfContentFetch:"",attachAsFile:!1,wfContentUpload:"",fileName:"",submitButton:!0}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},wesVersion:function(){return this.$store.getters["services/wesVersion"](this.serviceId)},inspected:function(){return"sapporo-1.0.1"!==this.wesVersion||!(!this.wfContentFetch&&!this.wfContentUpload)},wfNames:function(){return this.$store.getters["workflows/workflowsByIds"](this.service.workflowIds).map((function(e){return e.name}))},types:function(){var e=this.$store.getters["services/workflowLanguages"](this.serviceId),t=e.map((function(e){return e.name}));return 1===t.length&&(this.type=t[0]),e.map((function(e){return e.name}))},versions:function(){var e,t=ne(this.$store.getters["services/workflowLanguages"](this.serviceId));try{for(t.s();!(e=t.n()).done;){var o=e.value;if(o.name===this.type){var r=o.versions;return 1===r.length&&(this.version=r[0]),r}}}catch(e){t.e(e)}finally{t.f()}return[]},registerValid:function(){var content="fetch"===this.locationMode?!!this.wfContentFetch.length:!!this.wfContentUpload.length;return!this.nameRules.length&&!this.typeRules.length&&!this.versionRules.length&&!this.urlRules.length&&!this.fileNameRules.length&&content},nameRules:function(){return this.name?this.wfNames.includes(this.name)?["Typed name already exists"]:[]:["Required"]},typeRules:function(){return this.type?[]:["Required"]},versionRules:function(){return this.version?[]:["Required"]},urlRules:function(){if("fetch"===this.locationMode){if(!this.url)return["Required"];if(!Object(m.g)(this.url))return["Invalid URL"];if(this.fetchFailed)return["Failed to get the workflow content from the entered URL"]}return[]},fileNameRules:function(){return"upload"!==this.locationMode||this.fileName?[]:["Required"]}},methods:{changeType:function(){this.type&&1===this.versions.length?this.version=this.versions[0]:this.version=""},changeUrl:function(){for(var e=this;se.length;){var t=se.shift();t&&clearTimeout(t)}var o=setTimeout((function(t){e.fetchWfContent(t)}),1e3,this.url);se.push(o)},fetchWfContent:function(e){var t=this;Object(m.g)(e)?Object(m.b)(this.url).then((function(e){t.url=e,"sapporo-1.0.1"===t.wesVersion&&Object(j.g)(t.service.endpoint,{workflow_location:e,types_of_parsing:["workflow_type","workflow_type_version"]}).then((function(e){t.type=e.workflow_type||"",t.version=e.workflow_type_version||""})).catch((function(e){t.type="",t.version=""})),fetch(t.url).then((function(e){e.ok?e.text().then((function(content){t.fetchFailed=!1,t.wfContentFetch=content,t.name||(t.name=(t.url.split("/").pop()||"").replace(/\.[^/.]+$/,""))})):(t.fetchFailed=!0,t.wfContentFetch="")})).catch((function(e){t.fetchFailed=!0,t.wfContentFetch=""}))})):this.wfContentFetch=""},setDragFileName:function(e){var t,o,r,n;(null===(r=null===(o=null===(t=null==e?void 0:e.dataTransfer)||void 0===t?void 0:t.files)||void 0===o?void 0:o[0])||void 0===r?void 0:r.name)&&(this.fileName=null===(n=null==e?void 0:e.dataTransfer)||void 0===n?void 0:n.files[0].name,this.name||(this.name=(this.fileName.split("/").pop()||"").replace(/\.[^/.]+$/,"")))},submitWorkflow:function(){var e=this;if(this.registerValid){this.submitButton=!1;var t="";if("fetch"===this.locationMode)if(this.attachAsFile)t=new URL(this.url).pathname.split("/").pop()||this.url;else t=this.url;else t=this.fileName;this.$store.dispatch("workflows/submitWorkflow",{serviceId:this.serviceId,name:this.name,type:this.type,version:this.version,url:t,content:"fetch"===this.locationMode?this.wfContentFetch:this.wfContentUpload,preRegistered:!1}).then((function(t){e.$emit("close"),e.$router.push({path:"/workflows",query:{workflowId:t}})}))}},codeMirrorMode:function(content){return Object(m.a)(content)}},watch:{type:function(){"CWL"===this.type?this.attachAsFile=!1:this.attachAsFile=!0},wfContentUpload:function(){var e=this;"sapporo-1.0.1"===this.wesVersion&&this.wfContentUpload&&Object(j.g)(this.service.endpoint,{workflow_content:this.wfContentUpload,types_of_parsing:["workflow_type","workflow_type_version"]}).then((function(t){e.type=t.workflow_type||"",e.version=t.workflow_type_version||""})).catch((function(t){e.type="",e.version=""}))}}},le=n.a.extend(ae),ce=(o(574),o(591)),de=o(576),ue=Object(w.a)(le,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,"overlay-opacity":"0.8",width:"900"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Add Workflow")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2"},[e.inspected?o("v-text-field",{attrs:{"persistent-hint":!e.name.length,rules:e.nameRules,hint:"Name of the workflow (free text, e.g., 'Test workflow,' etc.)",label:"Name",placeholder:"Type a name"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}):e._e(),e._v(" "),e.inspected?o("v-select",{attrs:{items:e.types,"persistent-hint":!e.type.length,rule:e.typeRules,hint:"Select the workflow language type",label:"Type"},on:{change:e.changeType},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}):e._e(),e._v(" "),e.inspected?o("v-select",{attrs:{disabled:!e.type,items:e.versions,"persistent-hint":!e.type.length,rules:e.versionRules,hint:"Select the workflow language version",label:"Version"},model:{value:e.version,callback:function(t){e.version=t},expression:"version"}}):e._e()],1),e._v(" "),o("div",{staticClass:"mx-12 mt-2"},[o("div",{staticClass:"d-flex align-center"},[o("span",{style:{color:""+e.$colors.grey.darken2},domProps:{textContent:e._s("Document")}}),e._v(" "),o("v-chip-group",{staticClass:"ml-6",attrs:{mandatory:"",color:"primary"},model:{value:e.locationMode,callback:function(t){e.locationMode=t},expression:"locationMode"}},[o("v-chip",{attrs:{value:"fetch",label:"",outlined:""}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-download-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Fetch")}})],1),e._v(" "),o("v-chip",{attrs:{value:"upload",label:"",outlined:""}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-upload-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Upload")}})],1)],1)],1),e._v(" "),"fetch"===e.locationMode?o("div",{staticClass:"ml-4 d-flex flex-column"},[o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.url.length,rules:e.urlRules,hint:"Network reachable location of the workflow document",label:"URL",placeholder:"Type a URL"},on:{input:e.changeUrl},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),e._v(" "),e.wfContentFetch.length?o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.wfContentFetch),readOnly:"nocursor"}},model:{value:e.wfContentFetch,callback:function(t){e.wfContentFetch=t},expression:"wfContentFetch"}}):e._e()],1):"upload"===e.locationMode?o("div",{staticClass:"ml-4 d-flex flex-column"},[e.wfContentUpload.length?e._e():o("div",{staticClass:"mb-2"},[o("span",{style:{color:""+e.$colors.grey.darken2,fontSize:"0.9rem"},domProps:{textContent:e._s("Drag-and-Drop or Copy-and-Paste the document into the box below.")}})]),e._v(" "),e.wfContentUpload.length?o("v-text-field",{staticClass:"ma-0",attrs:{"persistent-hint":!e.fileName.length,rules:e.fileNameRules,hint:"The name of workflow document when it is placed in the execution directory and passed to the workflow engine",label:"File Name",placeholder:"Type a file name"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}):e._e(),e._v(" "),o("div",{on:{drop:e.setDragFileName}},[o("codemirror",{staticClass:"elevation-2 content-viewer",style:{outline:"solid 1px "+e.$colors.grey.lighten1},attrs:{options:{lineNumbers:!0,tabSize:2,mode:e.codeMirrorMode(e.wfContentUpload),readOnly:!1}},model:{value:e.wfContentUpload,callback:function(t){e.wfContentUpload=t},expression:"wfContentUpload"}})],1)],1):e._e()]),e._v(" "),o("div",{staticClass:"d-flex justify-end align-center mx-12 pb-6 mt-4"},["fetch"===e.locationMode&&e.wfContentFetch.length?o("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("div",e._g({staticClass:"mr-6"},r),[o("v-checkbox",{staticClass:"ma-0 pa-0",attrs:{"hide-details":"",label:"Attach as File"},model:{value:e.attachAsFile,callback:function(t){e.attachAsFile=t},expression:"attachAsFile"}})],1)]}}],null,!1,596384175)},[e._v(" "),o("span",{domProps:{textContent:e._s("Check this box if you want to place the workflow document in the execution directory and pass it as a local path, instead of passing the remote URL directly to the workflow engine.")}})]):e._e(),e._v(" "),o("v-btn",{attrs:{disabled:!(e.registerValid&&e.submitButton),color:"primary",outlined:""},on:{click:function(t){return t.stopPropagation(),e.submitWorkflow.apply(null,arguments)}}},[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-arrow-up")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Submit")}})],1)],1)])],1)}),[],!1,null,"6fc1914e",null),fe=ue.exports;k()(ue,{VBtn:x.a,VCard:_.a,VCheckbox:ce.a,VChip:C.a,VChipGroup:de.a,VDialog:F.a,VIcon:T.a,VSelect:Q.a,VTextField:z.a,VTooltip:P.a});o(69),o(280);var pe=o(122);function me(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return ve(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ve(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return l=e.done,e},e:function(e){c=!0,n=e},f:function(){try{l||null==o.return||o.return()}finally{if(c)throw n}}}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}var he=[],we=[{name:"WorkflowHub",endpoint:"https://workflowhub.eu/ga4gh/trs/v2"},{name:"Dockstore",endpoint:"https://dockstore.org/api/ga4gh/trs/v2"},{name:"BioContainers",endpoint:"https://api.biocontainers.pro/ga4gh/trs/v2"}],ge={components:{AppBar:l.a,AppFooter:c.a,WorkflowIcon:Y.a},props:{dialogShow:{type:Boolean,default:!1,required:!0},serviceId:{type:String,required:!0}},data:function(){return{trsEndpoint:we.filter((function(e){return"WorkflowHub"===e.name}))[0].endpoint,defaultEndpoints:we,fetchFailed:!1,serviceInfo:null,filterType:null,filterWorkflowName:"",filterOrganization:"",tableContents:[]}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},wfLangs:function(){return this.$store.getters["services/workflowLanguages"](this.serviceId)},wfTypes:function(){return this.wfLangs.map((function(e){return e.name}))},trsEndpointRules:function(){if(!this.trsEndpoint)return["Required"];if(!Object(m.g)(this.trsEndpoint))return["Invalid URL"];if(this.fetchFailed)return["Failed to fetch TRS response from the endpoint"];if(this.serviceInfo){if("trs"!==this.serviceInfo.type.artifact.toLowerCase())return["Not a TRS endpoint"];if(!this.serviceInfo.type.version.startsWith("2"))return["Not a TRS v2 endpoint"]}return[]},tableHeaders:function(){var e=[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"workflowNameVal",sortable:!0},{text:"Organization",value:"organization",sortable:!0},{text:"",value:"importButton",sortable:!1}];return"https://dockstore.org/api/ga4gh/trs/v2"!==this.trsEndpoint&&e.splice(3,0,{text:"Workflow URL",value:"workflowUrl",sortable:!1}),e},filteredTableContents:function(){var e=this;return this.tableContents.filter((function(t){return(!e.filterType||t.workflowType===e.filterType)&&(!(e.filterWorkflowName&&!t.workflowName.toLowerCase().includes(e.filterWorkflowName))&&!(e.filterOrganization&&!t.organization.toLowerCase().includes(e.filterOrganization)))}))},loading:function(){return!(!this.trsEndpoint||0!==this.tableContents.length||this.fetchFailed)}},methods:{changeTrsEndpoint:function(e){for(var t=this;he.length;){var o=he.shift();o&&clearTimeout(o)}var r=setTimeout((function(e){t.fetchTrs(e)}),500,this.trsEndpoint);he.push(r)},fetchTrs:function(e){var t=this;Object(m.g)(e)&&(this.trsEndpoint=e.replace(/\/$/,""),Object(pe.e)(this.trsEndpoint).then((function(e){t.fetchFailed=!1,t.serviceInfo=e,t.updateTableContents()})).catch((function(){t.fetchFailed=!0,t.serviceInfo=null})))},importWorkflow:function(e){var t=this;this.$store.dispatch("workflows/importWorkflowFromTrs",{serviceId:this.serviceId,trsEndpoint:this.trsEndpoint,trsWorkflowId:e.id,trsWorkflowVersion:e.version,trsWorkflowType:e.workflowType,trsWorkflowName:"".concat(e.workflowName,": ").concat(e.workflowVersion)}).then((function(e){t.$emit("close"),t.$router.push({path:"/workflows",query:{workflowId:e}})}))},updateTableContents:function(){var e=this;if(this.tableContents=[],this.serviceInfo&&"trs"===this.serviceInfo.type.artifact.toLowerCase()&&this.serviceInfo.type.version.startsWith("2")){var t,o=me(this.wfTypes);try{for(o.s();!(t=o.n()).done;){var r=t.value;Object(pe.f)(this.trsEndpoint,r).then((function(t){var o,r=me(t);try{for(r.s();!(o=r.n()).done;){var n,l=o.value,c=me(l.versions);try{for(c.s();!(n=c.n()).done;){var d=n.value;if(d.descriptor_type){var f,m=me(d.descriptor_type);try{for(m.s();!(f=m.n()).done;){var v=f.value,h={id:l.id,version:d.id,idVersionType:"".concat(l.id,"-").concat(d.id,"-").concat(v),workflowType:Object(pe.a)(v),workflowName:l.name?"".concat(l.name):"".concat(l.id,"-").concat(v),workflowNameVal:l.name?"".concat(l.name,"-").concat(d.id):"".concat(l.id,"-").concat(v,"-").concat(d.id),workflowVersion:d.id,organization:l.organization,workflowUrl:d.url,importButton:""};e.tableContents.push(h)}}catch(e){m.e(e)}finally{m.f()}}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){r.e(e)}finally{r.f()}})).catch((function(e){}))}}catch(e){o.e(e)}finally{o.f()}}}},mounted:function(){this.fetchTrs(this.trsEndpoint)}},ye=n.a.extend(ge),ke=o(577),xe=Object(w.a)(ye,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-dialog",{attrs:{value:e.dialogShow,eager:"","overlay-opacity":"0.8",width:"1200"},on:{"click:outside":function(t){return e.$emit("close")}}},[o("v-card",{staticClass:"pb-4"},[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-application-import")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Import Workflow from TRS")}})],1),e._v(" "),o("div",{staticClass:"mx-12 my-2 d-flex align-center"},[o("v-form",{ref:"form",staticClass:"flex-grow-1 mr-4"},[o("v-text-field",{attrs:{"persistent-hint":!e.trsEndpoint.length,rules:e.trsEndpointRules,hint:"Endpoint of the TRS (e.g., 'https://workflowhub.eu/ga4gh/trs/v2' etc.)",label:"TRS Endpoint",placeholder:"Type a TRS endpoint"},on:{input:e.changeTrsEndpoint},model:{value:e.trsEndpoint,callback:function(t){e.trsEndpoint=t},expression:"trsEndpoint"}})],1),e._v(" "),e._l(e.defaultEndpoints,(function(t,r){return o("v-btn",{key:t.name,class:{"text-capitalize":!0,"mr-2":r!==e.defaultEndpoints.length-1},attrs:{outlined:"",width:"110",small:""},domProps:{textContent:e._s(t.name)},on:{click:function(o){o.stopPropagation(),e.trsEndpoint=t.endpoint,e.fetchTrs(t.endpoint)}}})}))],2),e._v(" "),o("div",{staticClass:"d-flex mx-12"},[o("v-spacer"),e._v(" "),o("v-select",{staticClass:"mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{disabled:!e.tableContents.length,items:e.wfTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}),e._v(" "),o("v-text-field",{staticClass:"mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{disabled:!e.tableContents.length,"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Name","single-line":""},model:{value:e.filterWorkflowName,callback:function(t){e.filterWorkflowName=t},expression:"filterWorkflowName"}}),e._v(" "),o("v-text-field",{style:{maxWidth:"200px",minWidth:"200px"},attrs:{disabled:!e.tableContents.length,"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Organization","single-line":""},model:{value:e.filterOrganization,callback:function(t){e.filterOrganization=t},expression:"filterOrganization"}})],1),e._v(" "),o("v-data-table",{staticClass:"mx-12 my-2 workflow-table",attrs:{headers:e.tableHeaders,"items-per-page":Number(10),items:e.filteredTableContents,loading:e.loading,"item-key":"idVersionType"},scopedSlots:e._u([{key:"item.workflowType",fn:function(e){var t=e.item;return[o("workflow-icon",{attrs:{"wf-type":t.workflowType}})]}},{key:"item.workflowNameVal",fn:function(t){var r=t.item;return[o("span",[e._v("\n          "+e._s(r.workflowName)+"\n          "),o("v-chip",{staticClass:"ml-4",attrs:{color:e.$colors.indigo.lighten2,"text-color":"white",small:""},domProps:{textContent:e._s("ver. "+r.workflowVersion)}})],1)]}},{key:"item.workflowUrl",fn:function(t){var r=t.item;return[o("a",{attrs:{href:r.workflowUrl},domProps:{textContent:e._s(r.workflowUrl)}})]}},{key:"item.importButton",fn:function(t){var r=t.item;return[o("v-btn",{staticClass:"text-capitalize",attrs:{color:"primary",outlined:"",small:""},domProps:{textContent:e._s("Import")},on:{click:function(t){return t.stopPropagation(),e.importWorkflow(r)}}})]}}],null,!0)})],1)],1)}),[],!1,null,null,null),_e=xe.exports;k()(xe,{VBtn:x.a,VCard:_.a,VChip:C.a,VDataTable:I.a,VDialog:F.a,VForm:ke.a,VIcon:T.a,VSelect:Q.a,VSpacer:S.a,VTextField:z.a});var be={components:{WorkflowDeleteDialog:re,WorkflowIcon:Y.a,WorkflowRegisterDialog:fe,WorkflowTrsImportDialog:_e},props:{serviceId:{type:String,required:!0}},data:function(){return{workflowHeaders:[{text:"",value:"workflowType",sortable:!1,width:"40px"},{text:"Name",value:"workflowName",sortable:!0},{text:"Added / Updated Date",value:"date",sortable:!0},{text:"",value:"delete",sortable:!1,align:"center",width:"64px"}],selectedWorkflows:[],registerDialogShow:!1,importDialogShow:!1,deleteDialogShow:!1,filterType:"",filterName:""}},computed:{service:function(){return this.$store.getters["services/service"](this.serviceId)},workflowTableItems:function(){return this.$store.getters["workflows/tableItems"](this.service.workflowIds)},filteredItems:function(){var e=this;return this.workflowTableItems.filter((function(t){return(!e.filterType||t.workflowType===e.filterType)&&!(e.filterName&&!t.workflowName.includes(e.filterName))}))},registeredOnlyMode:function(){return this.$store.getters["services/registeredOnlyMode"](this.serviceId)},workflowTypes:function(){return Array.from(new Set(this.workflowTableItems.map((function(e){return e.workflowType}))))}}},Ce=n.a.extend(be),Ie=(o(578),Object(w.a)(Ce,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",{attrs:{"max-width":"1200"}},[o("div",{staticClass:"d-flex align-center mx-6 pt-4"},[o("v-icon",{attrs:{color:"black",left:""},domProps:{textContent:e._s("mdi-graph-outline")}}),e._v(" "),o("div",{staticClass:"card-header",domProps:{textContent:e._s("Workflows")}}),e._v(" "),o("v-spacer"),e._v(" "),e.workflowTableItems.length?o("v-select",{staticClass:"mt-2 mr-6",style:{maxWidth:"160px",minWidth:"160px"},attrs:{items:e.workflowTypes,"prepend-inner-icon":"mdi-filter-outline",clearable:"",dense:"","hide-details":"",label:"Type","single-line":""},model:{value:e.filterType,callback:function(t){e.filterType=t},expression:"filterType"}}):e._e(),e._v(" "),e.workflowTableItems.length?o("v-text-field",{staticClass:"mt-2 mr-6",style:{maxWidth:"200px",minWidth:"200px"},attrs:{"prepend-inner-icon":"mdi-magnify",clearable:"",dense:"","hide-details":"",label:"Name","single-line":""},model:{value:e.filterName,callback:function(t){e.filterName=t},expression:"filterName"}}):e._e()],1),e._v(" "),e.workflowTableItems.length?e._e():o("div",{staticClass:"mx-12 my-2"},[o("span",{style:{color:e.$vuetify.theme.themes.light.error,textDecorationLine:"underline",fontSize:"1rem"},domProps:{textContent:e._s("Add workflow to start composing a run.")}})]),e._v(" "),e.workflowTableItems.length?o("v-data-table",{staticClass:"mx-12 my-2 workflow-table",attrs:{headers:e.workflowHeaders,"items-per-page":Number(10),items:e.filteredItems,"item-key":"workflowId"},scopedSlots:e._u([{key:"item.workflowType",fn:function(e){var t=e.item;return[o("workflow-icon",{attrs:{"wf-type":t.workflowType}})]}},{key:"item.workflowName",fn:function(t){var r=t.item;return[o("div",{staticClass:"d-flex"},[o("nuxt-link",{style:{textDecoration:"none"},attrs:{to:{path:"/workflows",query:{workflowId:r.workflowId}}},domProps:{textContent:e._s(r.workflowName)}}),e._v(" "),o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r.preRegistered?o("v-icon",e._g({staticClass:"ml-2",attrs:{color:e.$colors.indigo.darken1,small:""},domProps:{textContent:e._s("mdi-account-check-outline")}},n)):e._e()]}}],null,!0)},[e._v(" "),o("span",{domProps:{textContent:e._s("Pre-registered workflow")}})])],1)]}},{key:"item.delete",fn:function(t){var r=t.item;return[o("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[o("div",e._g({},r.preRegistered&&n),[o("v-icon",{attrs:{disabled:r.preRegistered,color:e.$colors.grey.darken2},domProps:{textContent:e._s("mdi-trash-can-outline")},on:{click:function(t){t.stopPropagation(),e.selectedWorkflows=[r],e.deleteDialogShow=!0}}})],1)]}}],null,!0)},[e._v(" "),o("span",{domProps:{textContent:e._s("This workflow is pre-registered and cannot be removed.")}})])]}}],null,!0)}):e._e(),e._v(" "),o("div",{staticClass:"d-flex justify-end pb-6 mr-12 mt-2"},[o("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-btn",e._g({attrs:{disabled:e.registeredOnlyMode,color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.registerDialogShow=!0}}},e.registeredOnlyMode&&r),[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-sticker-plus-outline")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Add")}})],1)]}}])},[e._v(" "),o("span",{domProps:{textContent:e._s("This WES service operates in the mode of pre-registering workflows. Would you please ask your administrator to add workflows?")}})]),e._v(" "),o("v-tooltip",{attrs:{top:"","max-width":"400"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[o("v-btn",e._g({staticClass:"ml-4",attrs:{disabled:e.registeredOnlyMode,color:"primary",outlined:"",width:"140"},on:{click:function(t){t.stopPropagation(),e.importDialogShow=!0}}},e.registeredOnlyMode&&r),[o("v-icon",{attrs:{left:""},domProps:{textContent:e._s("mdi-application-import")}}),e._v(" "),o("span",{domProps:{textContent:e._s("Import")}})],1)]}}])},[e._v(" "),o("span",{domProps:{textContent:e._s("This WES service operates in the mode of pre-registering workflows. Would you please ask your administrator to import workflows?")}})])],1),e._v(" "),o("workflow-register-dialog",{attrs:{"dialog-show":e.registerDialogShow,"service-id":e.serviceId},on:{close:function(t){e.registerDialogShow=!1}}}),e._v(" "),o("workflow-delete-dialog",{attrs:{"dialog-show":e.deleteDialogShow,"selected-items":e.selectedWorkflows},on:{close:function(t){e.deleteDialogShow=!1,e.selectedWorkflow=[]}}}),e._v(" "),o("workflow-trs-import-dialog",{attrs:{"dialog-show":e.importDialogShow,"service-id":e.serviceId},on:{close:function(t){e.importDialogShow=!1}}})],1)}),[],!1,null,"2ddf6232",null)),Te=Ie.exports;k()(Ie,{VBtn:x.a,VCard:_.a,VDataTable:I.a,VIcon:T.a,VSelect:Q.a,VSpacer:S.a,VTextField:z.a,VTooltip:P.a});var Se={components:{AppBar:l.a,AppFooter:c.a,Breadcrumbs:d.a,InfoCard:W,RunCard:Z,WorkflowCard:Te},middleware:function(e){var t=e.store,o=e.route.query.serviceId||"";Array.isArray(o)&&(o=o[0]||""),window.onNuxtReady(Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dispatch("services/updateService",o);case 2:return e.next=4,t.dispatch("runs/updateAllRunsStateByService",o);case 4:case"end":return e.stop()}}),e)}))))},computed:{existServiceId:function(){return this.$store.getters["services/serviceIds"].includes(this.serviceId)},serviceId:function(){var e=this.$route.query.serviceId||"";return Array.isArray(e)?e[0]||"":e}}},Ne=n.a.extend(Se),Re=o(406),Ve=o(410),Pe=o(408),We=Object(w.a)(Ne,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-app",[o("app-bar"),e._v(" "),o("v-main",{staticClass:"background"},[o("v-container",{attrs:{fluid:""}},[o("breadcrumbs"),e._v(" "),e.existServiceId?[o("info-card",{staticClass:"mx-auto",attrs:{"service-id":e.serviceId}}),e._v(" "),o("workflow-card",{staticClass:"mt-8 mx-auto",attrs:{"service-id":e.serviceId}}),e._v(" "),o("run-card",{staticClass:"mt-8 mx-auto mb-4",attrs:{"service-id":e.serviceId}})]:[e._v(e._s("Service id: "+e.serviceId+" does not exist."))]],2)],1),e._v(" "),o("app-footer")],1)}),[],!1,null,null,null);t.default=We.exports;k()(We,{VApp:Re.a,VContainer:Ve.a,VMain:Pe.a})}}]);